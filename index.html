<form action = "" method = "post">
	<div>
		<label for="Score">轮空小分:</label>
		<input type = "number" id = "Score" name = "score_setting" min = 0 max = 2 value = 0>
	</div>
	<div>
		<label for="Rounds">总轮数:</label>
		<input type = "number" id = "Rounds" name = "rounds_setting" value = 0>
	</div>
	<div>
		<label for="Names>">名单文件:</label>
		<input type="file" id="Names" name = "Names_setting">
	</div>
	<div class="button">
		<button type="button" onclick = "start()">完成</button>
		<button type="reset">清空</button>
	</div>
</form>
<style>
	form {
	  /* Center the form on the page */
	  margin: 0 auto;
	  width: 400px;
	  /* Form outline */
	  padding: 1em;
	  border: 1px solid #CCC;
	  border-radius: 1em;
	}
</style>
<script>
	var totalRounds = 0;
	var currentRound = 0;
	var empty_score = 0;
	var totalCandidates = 0;
	var extras = 0;

	function start() {
		totalRounds = document.getElementById("Rounds");
		empty_score = document.getElementById("Score");

		if (document.getElementById("Names").files.length != 0) {
			  var file = document.getElementById("Names").files[0];
			  var reader = new FileReader();
			  reader.onload = function(progressEvent){
			    var lines = this.result.split('\n');
			    var innerHTML = "<table align=\"center\">" + generateHTMLForTableRow(["姓名", "总分", "小分"], true);

			    window.candidates = [];
			    for(var line = 0; line < lines.length; line++){
			      innerHTML = innerHTML + generateHTMLForTableRow([lines[line], 0, 0], false);
			      candidates.push({name: lines[line], totalScore:0, bonus:0, nextTable:-1, team:""});
			    }
			    console.log(window.candidates);

			    innerHTML += "</table>";
			    currentRound += 1;
			    innerHTML += generateHTMLForButtonForRound(currentRound);
			    totalCandidates = window.candidates.length;
			    extras = totalCandidates % 4;

			    document.body.innerHTML = innerHTML;
			  };
			  reader.readAsText(file);
		}
	};

	function generateHTMLForButtonForRound(round) {
		var text = "<center> <button type=\"button\" onclick=\"startRound()\"> 开始第" + round + "轮"+"</button></center>";
		return text;
	}

	function startRound() {
		var maxTotalScore = 0;
		for (var i = 0; i < window.candidates.length; i++) {
			if (window.candidates[i].totalScore > max) max = window.candidates[i].totalScore;
		}

	}

	function generateHTMLForTableRow(arr, isHeading) {
		var text = "<tr>"
		for (var i = 0; i < arr.length; i++) {
			if (isHeading) {
				text = text + "<th>" + arr[i] + "</th>";
			} else {
				text = text + "<td>" + arr[i] + "</td>";
			}
		}
		text += "</tr>";
		return text;
	}
</script>